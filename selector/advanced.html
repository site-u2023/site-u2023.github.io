<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>OpenWrt Firmware Selector Advanced</title>
    <link rel="stylesheet" href="index.css" />
    <link rel="stylesheet" href="advanced.css">
</head>
<body onload="init()">
    <header>
        <div>
            <a href="https://openwrt.org">
                <img src="logo.svg" width="180" alt="Logo" />
            </a>
            <div style="flex-grow: 1"></div>
        </div>
    </header>
    
    <div class="container">
        <h2 class="tr-load">OpenWrt Firmware Selector Advanced</h2>
        <p class="tr-message">
            Type the name or model of your device, then select a stable build or the nightly "snapshot" build.
        </p>

        <div class="form-row">
            <div class="form-group" style="flex: 2; margin-right: 10px;">
                <div class="autocomplete">
                    <input type="text" id="models" class="form-control" placeholder="Type device model" autocomplete="off">
                    <div id="models-autocomplete-list" class="autocomplete-items"></div>
                </div>
            </div>
            <div class="form-group" style="flex: 1;">
                <select id="versions" class="form-control">
                    <option value="" disabled selected>Loading versions...</option>
                </select>
            </div>
        </div>

        <div id="info" class="info" style="display: none;"></div>
        <div id="images" class="images" style="display: none;"></div>

        <div id="packages" class="packages">
            <h4>Customize installed packages and/or first boot script</h4>
            
            <div class="aios-section">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="use-package-selector">
                    <label class="form-check-label" for="use-package-selector">
                        Installed Packages
                    </label>
                </div>
                <div id="package-selector-config" class="aios-config">
                    <small class="text-muted">Select additional packages to install.
Selected packages will be automatically added to the package list below.</small>
                    <div id="package-categories"></div>
                    <div class="form-group" style="margin-top: 1.5rem;">
                        <label for="asu-packages">Packages</label>
                        <textarea id="asu-packages" class="form-control" rows="6" placeholder="luci&#10;luci-ssl&#10;-wpad-basic-wolfssl&#10;wpad-wolfssl"></textarea>
                    </div>
                </div>
            </div>
            
            <div class="aios-section">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="use-aios-config">
                    <label class="form-check-label" for="use-aios-config">
                        Script to run on first boot (uci-defaults)
                    </label>
                </div>
                <div id="aios-config" class="aios-config">
                    <h5>Basic Configuration</h5>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="aios-language">Language</label>
                            <select id="aios-language" class="form-control">
                                <option value="ja">日本語 (Japanese)</option>
                                <option value="en">English</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="aios-country">Country</label>
                            <input type="text" id="aios-country" class="form-control" placeholder="US" maxlength="2">
                            <small class="form-text text-muted">2-letter country code (e.g., US, JP)</small>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="aios-timezone">Timezone</label>
                            <input type="text" id="aios-timezone" class="form-control" placeholder="UTC">
                        </div>
                        <div class="form-group">
                            <label for="aios-zonename">Zone name</label>
                            <input type="text" id="aios-zonename" class="form-control" placeholder="America/New_York">
                            <small class="form-text text-muted">Optional: e.g., America/New_York, Asia/Tokyo</small>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="aios-lan-ip">LAN IP Address</label>
                            <input type="text" id="aios-lan-ip" class="form-control" placeholder="192.168.1.1" value="192.168.1.1">
                        </div>
                        <div class="form-group">
                            <label for="aios-device-name">Device name</label>
                            <input type="text" id="aios-device-name" class="form-control" placeholder="OpenWrt">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="aios-root-password">Root password</label>
                            <input type="password" id="aios-root-password" class="form-control" placeholder="8+ characters">
                            <small class="form-text text-muted">Leave empty to disable password authentication</small>
                        </div>
                        <div class="form-group">
                            <label for="aios-confirm-password">Confirm password</label>
                            <input type="password" id="aios-confirm-password" class="form-control" placeholder="Confirm password">
                        </div>
                    </div>
                    <h5>Wi-Fi Configuration</h5>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="aios-wifi-ssid">Wi-Fi SSID</label>
                            <input type="text" id="aios-wifi-ssid" class="form-control" placeholder="OpenWrt">
                        </div>
                        <div class="form-group">
                            <label for="aios-wifi-password">Wi-Fi password</label>
                            <input type="password" id="aios-wifi-password" class="form-control" placeholder="8+ characters">
                        </div>
                    </div>
                    <h5>Internet Connection</h5>
                    <div class="form-group">
                        <label>Connection mode</label>
                        <div class="radio-group">
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="connectionMode" id="mode-auto" value="auto" checked>
                                <label class="form-check-label" for="mode-auto">Auto (Recommended)</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="connectionMode" id="mode-manual" value="manual">
                                <label class="form-check-label" for="mode-manual">Manual</label>
                            </div>
                        </div>
                    </div>
                    <div id="manual-connection-section" class="conditional-section" style="background-color: #fff3cd; border: 1px solid #ffeaa7;">
                        <div class="form-group">
                            <label>Connection type</label>
                            <div class="radio-group">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="connectionType" id="conn-dhcp" value="dhcp" checked>
                                    <label class="form-check-label" for="conn-dhcp">DHCP</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="connectionType" id="conn-pppoe" value="pppoe">
                                    <label class="form-check-label" for="conn-pppoe">PPPoE</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="connectionType" id="conn-dslite" value="dslite">
                                    <label class="form-check-label" for="conn-dslite">DS-Lite</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="connectionType" id="conn-mape" value="mape">
                                    <label class="form-check-label" for="conn-mape">MAP-E</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="connectionType" id="conn-none" value="none">
                                    <label class="form-check-label" for="conn-none">None</label>
                                </div>
                            </div>
                        </div>
                        <div id="pppoe-section" class="conditional-section" style="background-color: #e3f2fd;">
                            <h6>PPPoE Configuration</h6>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="pppoe-username">PPPoE username</label>
                                    <input type="text" id="pppoe-username" class="form-control" placeholder="Username">
                                </div>
                                <div class="form-group">
                                    <label for="pppoe-password">PPPoE password</label>
                                    <input type="password" id="pppoe-password" class="form-control" placeholder="Password">
                                </div>
                            </div>
                        </div>
                        <div id="dslite-section" class="conditional-section" style="background-color: #fff3e0;">
                            <h6>DS-Lite Configuration</h6>
                            <div class="form-group">
                                <label>DS-Lite Configuration Mode</label>
                                <div class="radio-group">
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="dsliteMode" id="dslite-auto" value="auto" checked>
                                        <label class="form-check-label" for="dslite-auto">Auto (Recommended)</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="dsliteMode" id="dslite-manual" value="manual">
                                        <label class="form-check-label" for="dslite-manual">Manual</label>
                                    </div>
                                </div>
                            </div>
                            <div id="dslite-manual-section" class="conditional-section" style="background-color: #e3f2fd;">
                                <h6>Manual DS-Lite Configuration</h6>
                                <div class="form-group">
                                    <label for="dslite-aftr-type">AFTR IPv6 Address Type</label>
                                    <select id="dslite-aftr-type" class="form-control">
                                        <option value="hostname" selected>Hostname</option>
                                        <option value="ipv6">IPv6 Address</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="dslite-aftr">AFTR Hostname or IPv6 Address</label>
                                    <input type="text" id="dslite-aftr" class="form-control" placeholder="gw-t.transix.jp">
                                </div>
                            </div>
                        </div>
                        <div id="mape-section" class="conditional-section" style="background-color: #e3f2fd;">
                            <h6>MAP-E Configuration</h6>
                            <div class="form-group">
                                <label>MAP-E Configuration Mode</label>
                                <div class="radio-group">
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="mapeMode" id="mape-auto" value="auto" checked>
                                        <label class="form-check-label" for="mape-auto">Auto (Recommended)</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="mapeMode" id="mape-manual" value="manual">
                                        <label class="form-check-label" for="mape-manual">Manual</label>
                                    </div>
                                </div>
                            </div>
                            <div id="mape-manual-section" class="conditional-section" style="background-color: #e0f2f1;">
                                <h6>Manual MAP-E Configuration</h6>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="mape-br">BR IPv6 Address</label>
                                        <input type="text" id="mape-br" class="form-control" placeholder="2404:1a8:a060:c::a">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="mape-ealen">EA-bit length</label>
                                        <input type="number" id="mape-ealen" class="form-control" value="48">
                                    </div>
                                    <div class="form-group">
                                        <label for="mape-psidlen">PSID length</label>
                                        <input type="number" id="mape-psidlen" class="form-control" value="4">
                                    </div>
                                    <div class="form-group">
                                        <label for="mape-psid-offset">PSID offset</label>
                                        <input type="number" id="mape-psid-offset" class="form-control" value="6">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="mape-ipv4-prefix">IPv4 prefix</label>
                                        <input type="text" id="mape-ipv4-prefix" class="form-control" placeholder="10.0.0.0">
                                    </div>
                                    <div class="form-group">
                                        <label for="mape-ipv4-prefixlen">IPv4 prefix length</label>
                                        <input type="number" id="mape-ipv4-prefixlen" class="form-control" value="24">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="mape-ipv6-prefix">IPv6 prefix</label>
                                        <input type="text" id="mape-ipv6-prefix" class="form-control" placeholder="2404:1a8:a060::">
                                    </div>
                                    <div class="form-group">
                                        <label for="mape-ipv6-prefixlen">IPv6 prefix length</label>
                                        <input type="number" id="mape-ipv6-prefixlen" class="form-control" value="64">
                                    </div>
                                </div>
                            </div>
                            <div id="mape-gua-section">
                                <div class="form-group">
                                    <label>MAP-E GUA Address</label>
                                    <div class="radio-group">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="mapeType" id="mape-gua" value="gua" checked>
                                            <label class="form-check-label" for="mape-gua">GUA</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="mapeType" id="mape-pd" value="pd">
                                            <label class="form-check-label" for="mape-pd">PD</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="mape-gua-prefix">GUA prefix</label>
                                    <input type="text" id="mape-gua-prefix" class="form-control" placeholder="2404:1a8:a060:c::/64">
                                    <small class="form-text text-muted">A valid IPv6 prefix, e.g., 2001:db8::/64</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <button id="request-build" class="btn btn-primary" style="display: none;">Request Build</button>
            <div id="asu-buildstatus" class="asu-info" style="display: none;">
                <p>Build Status: <span id="build-status-message"></span></p>
                <div id="build-progress" class="build-progress">
                    <p id="build-message"></p>
                    <div class="progress">
                        <div id="progress-bar" class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                </div>
            </div>
            <div id="build-output" class="build-output" style="display: none;"></div>
        </div>
    </div>
    
    <script src="advanced.js"></script>
    <script src="config.js"></script>
    <script src="index.js"></script>

    <div id="footer">
        <span><a href="https://downloads.openwrt.org" class="tr-server-link">All Downloads</a></span>
        |
        <span><a href="https://forum.openwrt.org/t/the-openwrt-firmware-selector/81721" class="tr-feedback-link">Feedback</a></span>
        |
        <span><a href="https://github.com/openwrt/firmware-selector-openwrt-org/">OFS <span id="ofs-version">0.0.0</span></a></span>
    </div>
</body>
</html>
