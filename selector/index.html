<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>OpenWrt Firmware Selector</title>
    <link rel="icon" href="favicon.ico" />
    <link rel="stylesheet" href="index.css" />
    <link rel="stylesheet" href="advanced.css">
    <script src="config.js"></script>
    <script src="./js/index.js"></script>
    <script src="./js/advanced.js"></script>
  </head>
  <body>
    <!-- header across the whole page -->
    <header>
      <div>
        <a href="https://openwrt.org">
          <img src="logo.svg" width="180" alt="Logo" />
        </a>
        <div style="flex-grow: 1"></div>
        <div>
          <select id="languages-select">
            <!-- 言語オプション省略 -->
          </select>
          <button id="languages-button"></button>
        </div>
      </div>
    </header>

    <div id="alert" class="hide"></div>

    <div class="container">
      <div>
        <h2 class="tr-load">Download OpenWrt Firmware for your Device</h2>
        <p class="tr-message">
          Type the name or model of your device, then select a stable build or
          the nightly "snapshot" build.
        </p>

        <!-- Model name and Build dropdown -->
        <div id="models-autocomplete" class="autocomplete">
          <input
            id="models"
            type="text"
            class="tr-model"
            placeholder="Model"
            spellcheck="false"
            autocapitalize="off"
            autofocus
          />
          <select id="versions" size="1"></select>
        </div>

        <div id="notfound" class="hide">
          <h3 class="tr-not-found">No model found!</h3>
        </div>

        <div id="info" class="hide">
          <!-- Device info will be dynamically generated -->
        </div>

        <div id="images" class="hide">
          <!-- Device images will be shown here -->
        </div>

        <div id="packages" class="hide">
          <details id="asu">
            <summary>Customize installed packages and/or first boot script</summary>
            
            <!-- パッケージセレクターセクション -->
            <div class="aios-section">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="use-package-selector">
                <label class="form-check-label" for="use-package-selector">
                  Installed Packages
                </label>
              </div>

              <div id="package-selector-config" class="aios-config">
                <small class="text-muted">Select additional packages to install.</small>
                
                <div id="package-categories">
                  <!-- カテゴリーとパッケージは動的に生成される -->
                </div>
                
                <div class="form-group" style="margin-top: 1.5rem;">
                  <label for="asu-packages">Packages</label>
                  <textarea id="asu-packages" class="form-control" rows="6"></textarea>
                </div>
              </div>
            </div>

            <!-- setup.sh設定セクション -->
            <div class="aios-section">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="use-aios-config">
                <label class="form-check-label" for="use-aios-config">
                  Script to run on first boot (uci-defaults)
                </label>
              </div>

              <div id="aios-config" class="aios-config">
                <!-- 設定フィールドは同じ -->
                <!-- 省略 -->
              </div>
            </div>

            <a href="javascript:buildAsuRequest()" class="custom-link" id="request-build">
              <span></span>
              <span class="tr-request-build">REQUEST BUILD</span>
            </a>
          </details>
        </div>

        <!-- Build progress -->
        <div id="build-progress" class="build-progress">
          <div id="build-message">Building image...</div>
          <div class="progress">
            <div id="progress-bar" class="progress-bar" style="width: 0%"></div>
          </div>
        </div>

        <div id="asu-buildstatus" class="asu-info hide">
          <span></span>
        </div>

        <div id="asu-log" class="hide">
          <details>
            <summary>STDERR</summary>
            <pre id="asu-stderr"></pre>
          </details>
          <details>
            <summary>STDOUT</summary>
            <pre id="asu-stdout"></pre>
          </details>
        </div>

        <div id="download-links"></div>
      </div>
    </div>

  </body>
</html>
