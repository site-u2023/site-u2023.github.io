<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ワンクリックSSH</title>
  <style>
    body { font-family: Meiryo; padding:2em; }
    a.btn {
      display:inline-block;
      padding:1em 2em;
      background:#0078d4;
      color:#fff;
      text-decoration:none;
      border-radius:4px;
      font-size:1rem;
    }
  </style>
</head>
<body>
  <h1>SSH を一発起動</h1>
  <p>以下のボタンをクリックするだけで、自動的に PowerShell → DNSゲートウェイ解決 → SSH が始まります。</p>
  <a id="sshBtn" class="btn" href="sshps://">SSH 起動</a>

  <script>
    // 実行したい PowerShell コード（改行なしで一行）
    const ps = [
      '$dns=(Get-DnsClientServerAddress -AddressFamily IPv4)[0].ServerAddresses[0]',
      '$gw=(Get-NetIPConfiguration | Where{$_.IPv4DefaultGateway}).IPv4DefaultGateway.NextHop',
      '$ip=(Resolve-DnsName -Name $gw -Server $dns -ErrorAction Stop).IPAddress',
      'ssh root@$ip'
    ].join(';');

    // URL エンコードしてリンクを書き換え
    const encoded = encodeURIComponent(ps);
    document.getElementById('sshBtn').href = 'sshps://' + encoded;
  </script>
</body>
</html>
